Инструкция по написанию
Подход — «Модульный монолит» (Skeleton-first + Modular implementation).

Стратегия работы:
Этап «Скелет»: Сначала мы создаем архитектурный план. Это файлы-заглушки (например, database.py, rag_engine.py, bot_handlers.py, config.py) и main.py, который их объединяет. Внутри — только названия функций, классов и описание того, что они принимают на вход и отдают (type hinting).

Этап «Контракт данных»: Мы фиксируем, в каком формате данные переходят от одного модуля к другому. Например, «Модуль поиска возвращает список из объектов Document с полями text и source_url».

Этап «Изолированная разработка»: Мы берем один файл (например, rag_engine.py) и пишем его логику до победного конца. Когда он готов, мы «забываем» о его внутренностях и переходим к следующему.

Этап «Глобальный контекст»: При написании каждого нового модуля ты присылаешь мне «Скелет» (интерфейсы) и актуальный модуль. Так я вижу общую картину, не перегружая память деталями других блоков.